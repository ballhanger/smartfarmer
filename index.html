<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ Smart Farmer</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Sarabun', 'sans-serif'] },
                    colors: {
                        kaset: { 50: '#f2fbf5', 100: '#e1f6e8', 500: '#22c55e', 600: '#16a34a', 700: '#15803d', 900: '#14532d' },
                        q1: '#0ea5e9', /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏• Q1 */
                        q2: '#16a34a', /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏• Q2 */
                    }
                }
            }
        }
    </script>
    <!-- Google Fonts: Sarabun -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
        .conic-chart { transition: background 1s ease-in-out; }
        .bar-chart-col { transition: height 0.7s cubic-bezier(0.4, 0, 0.2, 1); }
        
        /* ‡∏™‡∏£‡πâ‡∏≤‡∏á Animation ‡πÄ‡∏ö‡∏≤‡πÜ ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ */
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(234, 179, 8, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(234, 179, 8, 0); }
            100% { box-shadow: 0 0 0 0 rgba(234, 179, 8, 0); }
        }
        .status-highlight {
            animation: pulse-border 2s infinite;
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8 text-slate-800">
    
    <div class="max-w-7xl mx-auto">
        
        <!-- Header: ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏ô‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏µ‡∏î‡∏≥ -->
        <header class="mb-8 border-b-4 border-kaset-600 pb-4">
            <p class="text-lg md:text-xl font-semibold text-slate-500 mb-1">Dashboard ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</p>
            <h1 id="project-name" class="text-xl md:text-2xl font-bold text-black leading-relaxed"></h1>
        </header>

        <!-- Top KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 flex items-center justify-between border-l-4 border-l-blue-500">
                <div>
                    <p class="text-sm font-medium text-slate-500 mb-1">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</p>
                    <h2 class="text-4xl font-bold text-slate-800" id="kpi-target">-</h2>
                </div>
                <div class="bg-blue-50 p-4 rounded-full">
                    <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                </div>
            </div>
            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 flex items-center justify-between border-l-4 border-l-kaset-500">
                <div>
                    <p class="text-sm font-medium text-slate-500 mb-1">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°</p>
                    <h2 class="text-4xl font-bold text-slate-800" id="kpi-actual">-</h2>
                </div>
                <div class="bg-kaset-50 p-4 rounded-full">
                    <svg class="w-8 h-8 text-kaset-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path></svg>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <!-- Section 4: ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ (Pie Chart) -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 lg:col-span-1 flex flex-col justify-between">
                <h3 class="text-lg font-bold mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path></svg>
                    ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
                </h3>
                
                <div class="flex-grow flex items-center justify-center my-6">
                    <div id="pie-chart" class="conic-chart w-56 h-56 rounded-full relative flex items-center justify-center shadow-inner" style="background: conic-gradient(#e2e8f0 0% 100%);">
                        <div class="w-40 h-40 bg-white rounded-full flex flex-col items-center justify-center z-10 shadow-sm border-4 border-slate-50">
                            <span class="text-4xl font-extrabold text-slate-800" id="pie-percent">0%</span>
                            <span class="text-sm text-slate-500 font-medium">‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞‡∏ú‡∏•‡∏á‡∏≤‡∏ô</span>
                        </div>
                    </div>
                </div>

                <div class="mt-4 flex flex-col items-center text-center">
                    <p class="text-sm text-slate-500 mb-2 font-medium">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 2)</p>
                    <div id="project-status" class="inline-flex items-center justify-center px-6 py-3 rounded-xl text-xl font-bold border-2 shadow-md w-full sm:w-auto">
                        <!-- Content generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Section 6: ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ (Bar Chart) -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 lg:col-span-2 flex flex-col">
                <h3 class="text-lg font-bold mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ (‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ú‡∏ô/‡∏ú‡∏• ‡∏™‡∏∞‡∏™‡∏°)
                </h3>
                
                <div class="flex-grow pt-10 relative h-72">
                    <!-- Legend -->
                    <div class="flex justify-center space-x-6 mb-6 text-sm font-medium text-slate-600">
                        <div class="flex items-center"><div class="w-4 h-4 bg-slate-300 mr-2 rounded-sm border border-slate-400"></div> ‡πÅ‡∏ú‡∏ô‡∏™‡∏∞‡∏™‡∏° (‡∏ó‡∏∏‡∏Å‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™)</div>
                        <div class="flex items-center"><div class="w-4 h-4 bg-[#0ea5e9] mr-2 rounded-sm"></div> ‡∏ú‡∏• Q1</div>
                        <div class="flex items-center"><div class="w-4 h-4 bg-[#16a34a] mr-2 rounded-sm"></div> ‡∏ú‡∏• Q2</div>
                    </div>
                    
                    <!-- Chart Area -->
                    <div class="absolute inset-0 top-16 bottom-8 border-b-2 border-slate-300 flex items-end justify-around px-2 sm:px-4" id="bar-chart-container">
                        <!-- Bars will be generated here by JS -->
                    </div>
                </div>
                <div class="mt-4 text-sm text-slate-500 text-center bg-slate-50 p-2 rounded-lg inline-block mx-auto">
                    üìå ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 3 ‡πÅ‡∏•‡∏∞ 4 ‡πÑ‡∏ß‡πâ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™‡∏ó‡∏µ‡πà 2
                </div>
            </div>
        </div>

        <!-- Section 5: ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç -->
        <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 mb-8">
            <h3 class="text-lg font-bold mb-6 flex items-center border-b pb-3">
                <svg class="w-5 h-5 mr-2 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path></svg>
                ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 2)
            </h3>
            
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4" id="summary-cards">
                <!-- Summary cards generated by JS -->
            </div>
        </div>

        <!-- Section 7: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° -->
        <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden mb-12">
            <div class="p-6 border-b border-slate-100 bg-slate-50">
                <h3 class="text-lg font-bold flex items-center text-slate-800">
                    <svg class="w-5 h-5 mr-2 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                    ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
                </h3>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left">
                    <thead class="text-xs text-slate-600 bg-slate-100 border-b-2 border-slate-200">
                        <tr>
                            <th class="px-6 py-4 font-bold w-1/3">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
                            <th class="px-4 py-4 font-bold text-center w-20">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö</th>
                            <th class="px-4 py-4 font-bold text-right w-24">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</th>
                            <th class="px-4 py-4 font-bold text-right w-24">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°</th>
                            <th class="px-6 py-4 font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ú‡∏ô‡∏™‡∏∞‡∏™‡∏°)</th>
                            <th class="px-6 py-4 font-bold text-center w-36">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- Table rows generated by JS -->
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- JavaScript ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• -->
    <script>
        // 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
        const projectData = {
            name: "‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏Å‡∏©‡∏ï‡∏£ (‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏õ‡∏£‡∏≤‡∏î‡πÄ‡∏õ‡∏£‡∏∑‡πà‡∏≠‡∏á (Smart Farmer))",
            target: 11250, 
            actualCum: 8138, 
            percentCum: 72.34, 
            statusQ2: "üü° ‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤", 
            planQ1: 10720, actualQ1: 5452,
            planQ2: 530, actualQ2: 2686,
            planQ3: 0, 
            planQ4: 0  
        };

        // 2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 11 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Sheet 
        const activities = [
            { id: 1, name: "1. (KPI) ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Smart Farmer ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Smart Farmer", unit: "‡∏£‡∏≤‡∏¢", target: 8820, actual: 6460, planQ1: 8820, planQ2: 0, planQ3: 0, planQ4: 0, status: "üü° ‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤" },
            { id: 2, name: "2. ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û Smart Farmer ‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û Smart Farmer ‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤", unit: "‡∏à‡∏∏‡∏î", target: 77, actual: 0, planQ1: 0, planQ2: 0, planQ3: 77, planQ4: 0, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" },
            { id: 3, name: "3. ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏ó‡∏´‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏Å‡∏≤‡∏£‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏¢‡∏≤‡∏ó‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£", unit: "‡∏£‡∏≤‡∏¢", target: 200, actual: 0, planQ1: 0, planQ2: 0, planQ3: 0, planQ4: 200, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" },
            { id: 4, name: "4. (KPI) ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Young Smart Farmer ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Young Smart Farmer", unit: "‡∏£‡∏≤‡∏¢", target: 1900, actual: 1423, planQ1: 1900, planQ2: 0, planQ3: 0, planQ4: 0, status: "üü° ‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤" },
            { id: 5, name: "5. ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û Young Smart Farmer ‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û Young Smart Farmer ‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û", unit: "‡∏£‡∏≤‡∏¢", target: 390, actual: 0, planQ1: 0, planQ2: 0, planQ3: 390, planQ4: 0, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" },
            { id: 6, name: "6. ‡πÄ‡∏ß‡∏ó‡∏µ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ Smart Farmer & Young Smart Farmer", unit: "‡∏£‡∏≤‡∏¢", target: 480, actual: 0, planQ1: 0, planQ2: 0, planQ3: 480, planQ4: 0, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" },
            { id: 7, name: "7. (KPI) ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏ä‡∏¥‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏Å‡∏©‡∏ï‡∏£ ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏π‡πà‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£", unit: "‡∏£‡∏≤‡∏¢", target: 530, actual: 255, planQ1: 0, planQ2: 530, planQ3: 0, planQ4: 0, status: "üî¥ ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á" },
            { id: 8, name: "8. ‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏ß‡∏¥‡∏à‡∏±‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£ ‡πÇ‡∏î‡∏¢‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏©‡∏ï‡∏£", unit: "‡∏á‡∏≤‡∏ô", target: 6, actual: 0, planQ1: 0, planQ2: 0, planQ3: 6, planQ4: 0, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" },
            { id: 9, name: "9. ‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πà‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£ ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ Plant Science Academy", unit: "‡∏£‡∏≤‡∏¢", target: 100, actual: 0, planQ1: 0, planQ2: 0, planQ3: 100, planQ4: 0, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" },
            { id: 10, name: "10. ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ Smart Farmer & Young Smart Farmer", unit: "‡∏á‡∏≤‡∏ô", target: 2, actual: 0, planQ1: 0, planQ2: 0, planQ3: 1, planQ4: 1, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" },
            { id: 11, name: "11. ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£", unit: "‡∏Ñ‡∏£‡∏±‡πâ‡∏á", target: 10, actual: 0, planQ1: 0, planQ2: 1, planQ3: 6, planQ4: 3, status: "‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" }
        ];

        const formatNum = (num) => new Intl.NumberFormat('th-TH').format(num);

        const getStatusStyles = (status) => {
            if (status.includes("‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô")) return "bg-green-100 text-green-800 border-green-300";
            if (status.includes("‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤")) return "bg-yellow-100 text-yellow-800 border-yellow-300 status-highlight";
            if (status.includes("‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á")) return "bg-red-100 text-red-800 border-red-300";
            return "bg-slate-100 text-slate-600 border-slate-300";
        };

        document.addEventListener('DOMContentLoaded', () => {
            
            document.getElementById('project-name').textContent = projectData.name;
            document.getElementById('kpi-target').innerHTML = `${formatNum(projectData.target)} <span class="text-xl font-medium text-slate-500">‡∏£‡∏≤‡∏¢</span>`;
            document.getElementById('kpi-actual').innerHTML = `${formatNum(projectData.actualCum)} <span class="text-xl font-medium text-slate-500">‡∏£‡∏≤‡∏¢</span>`;
            
            const pieChart = document.getElementById('pie-chart');
            const piePercent = document.getElementById('pie-percent');
            piePercent.textContent = projectData.percentCum + '%';
            
            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
            let pieColor = "#16a34a"; // ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß Default (‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô)
            if (projectData.statusQ2.includes("‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤")) pieColor = "#eab308"; // ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
            if (projectData.statusQ2.includes("‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á")) pieColor = "#ef4444"; // ‡πÅ‡∏î‡∏á

            setTimeout(() => {
                pieChart.style.background = `conic-gradient(${pieColor} 0% ${projectData.percentCum}%, #e2e8f0 ${projectData.percentCum}% 100%)`;
            }, 100);

            const statusEl = document.getElementById('project-status');
            statusEl.textContent = projectData.statusQ2;
            statusEl.className = `inline-flex items-center justify-center px-8 py-4 rounded-2xl text-2xl font-bold border-2 shadow-lg w-full sm:w-auto ${getStatusStyles(projectData.statusQ2)}`;

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Bar Chart
            const qData = [
                { name: '‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 1', plan: projectData.planQ1, actual: projectData.actualQ1, showActual: true, actualColor: 'bg-[#0ea5e9]' },
                { name: '‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 2', plan: projectData.planQ1 + projectData.planQ2, actual: projectData.actualQ1 + projectData.actualQ2, showActual: true, actualColor: 'bg-[#16a34a]' },
                { name: '‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 3', plan: projectData.planQ1 + projectData.planQ2 + projectData.planQ3, actual: 0, showActual: false, actualColor: '' },
                { name: '‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 4', plan: projectData.planQ1 + projectData.planQ2 + projectData.planQ3 + projectData.planQ4, actual: 0, showActual: false, actualColor: '' }
            ];
            
            const maxVal = Math.max(...qData.map(d => d.plan)) * 1.25; 

            const barContainer = document.getElementById('bar-chart-container');
            qData.forEach(q => {
                const planHeight = (q.plan / maxVal) * 100;
                const actualHeight = q.showActual ? (q.actual / maxVal) * 100 : 0;
                
                const actualBarHtml = q.showActual ? `
                    <div class="flex flex-col items-center justify-end h-full">
                        <span class="text-xs sm:text-sm font-bold text-slate-700 mb-1 absolute bottom-full pb-1 opacity-0 transition-opacity duration-700 delay-300" style="bottom: ${actualHeight}%">${formatNum(q.actual)}</span>
                        <div class="w-6 sm:w-10 md:w-16 ${q.actualColor} rounded-t-md bar-chart-col shadow-sm" style="height: 0%" data-h="${actualHeight}"></div>
                    </div>
                ` : `<div class="w-6 sm:w-10 md:w-16 bg-transparent"></div>`;

                barContainer.innerHTML += `
                    <div class="flex flex-col items-center w-1/4 h-full justify-end">
                        <div class="flex items-end space-x-1 sm:space-x-2 h-full w-full justify-center relative pb-0">
                            <!-- ‡πÅ‡∏ó‡πà‡∏á‡πÅ‡∏ú‡∏ô -->
                            <div class="flex flex-col items-center justify-end h-full">
                                <span class="text-xs sm:text-sm font-bold text-slate-500 mb-1 absolute bottom-full pb-1 opacity-0 transition-opacity duration-700 delay-300" style="bottom: ${planHeight}%">${formatNum(q.plan)}</span>
                                <div class="w-6 sm:w-10 md:w-16 bg-slate-300 border border-slate-400 rounded-t-md bar-chart-col" style="height: 0%" data-h="${planHeight}"></div>
                            </div>
                            
                            <!-- ‡πÅ‡∏ó‡πà‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô -->
                            ${actualBarHtml}
                        </div>
                        <div class="mt-3 text-sm font-bold text-slate-600">${q.name}</div>
                    </div>
                `;
            });

            setTimeout(() => {
                document.querySelectorAll('.bar-chart-col').forEach(bar => {
                    bar.style.height = bar.getAttribute('data-h') + '%';
                });
                document.querySelectorAll('.opacity-0').forEach(text => {
                    text.classList.remove('opacity-0');
                });
            }, 100);

            // ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î
            const summary = {
                total: activities.length,
                onTrack: activities.filter(a => a.status.includes("‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô")).length,
                delayed: activities.filter(a => a.status.includes("‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤")).length,
                atRisk: activities.filter(a => a.status.includes("‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á")).length,
                notStarted: activities.filter(a => a.status.includes("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£")).length,
            };

            document.getElementById('summary-cards').innerHTML = `
                <div class="col-span-2 md:col-span-1 bg-slate-100 rounded-xl p-4 text-center border-2 border-slate-300">
                    <p class="text-sm font-bold text-slate-500 mb-1">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    <p class="text-4xl font-extrabold text-slate-800">${summary.total}</p>
                </div>
                <div class="bg-green-50 rounded-xl p-4 border-2 border-green-200 text-center">
                    <p class="text-sm font-bold text-green-700 mb-1">‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô</p>
                    <p class="text-4xl font-extrabold text-green-700">${summary.onTrack}</p>
                </div>
                <div class="bg-yellow-50 rounded-xl p-4 border-2 border-yellow-200 text-center shadow-sm">
                    <p class="text-sm font-bold text-yellow-700 mb-1">‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤</p>
                    <p class="text-4xl font-extrabold text-yellow-700">${summary.delayed}</p>
                </div>
                <div class="bg-red-50 rounded-xl p-4 border-2 border-red-200 text-center shadow-sm">
                    <p class="text-sm font-bold text-red-700 mb-1">‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</p>
                    <p class="text-4xl font-extrabold text-red-700">${summary.atRisk}</p>
                </div>
                <div class="bg-white rounded-xl p-4 border-2 border-slate-200 text-center border-dashed">
                    <p class="text-sm font-bold text-slate-500 mb-1">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</p>
                    <p class="text-4xl font-extrabold text-slate-400">${summary.notStarted}</p>
                </div>
            `;

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const tbody = document.getElementById('table-body');
            activities.forEach(act => {
                
                const safeTarget = act.target > 0 ? act.target : 1;
                const pct = (act.actual / safeTarget) * 100;
                const q1Pos = Math.min((act.planQ1 / safeTarget) * 100, 100);
                const q2Pos = Math.min(((act.planQ1 + act.planQ2) / safeTarget) * 100, 100);
                const q3Pos = Math.min(((act.planQ1 + act.planQ2 + act.planQ3) / safeTarget) * 100, 100);

                // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
                let barColor = "bg-slate-300"; // ‡∏™‡∏µ Default ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£"
                if (act.status.includes("‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô")) barColor = "bg-[#16a34a]"; // ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                if (act.status.includes("‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤")) barColor = "bg-yellow-400"; // ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
                if (act.status.includes("‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á")) barColor = "bg-red-500"; // ‡∏™‡∏µ‡πÅ‡∏î‡∏á

                let markersHtml = '';
                if(q1Pos > 0) markersHtml += `<div class="absolute top-[20px] bottom-[-15px] border-l-2 border-slate-800 z-10 flex flex-col items-center" style="left: ${q1Pos}%"><div class="h-4 w-px bg-slate-800"></div><span class="text-[10px] font-bold text-slate-700 mt-1 bg-white px-1 border rounded">Q1</span></div>`;
                if(q2Pos > q1Pos) markersHtml += `<div class="absolute top-[20px] bottom-[-15px] border-l-2 border-slate-800 z-10 flex flex-col items-center" style="left: ${q2Pos}%"><div class="h-4 w-px bg-slate-800"></div><span class="text-[10px] font-bold text-slate-700 mt-1 bg-white px-1 border rounded">Q2</span></div>`;
                if(q3Pos > q2Pos) markersHtml += `<div class="absolute top-[20px] bottom-[-15px] border-l-2 border-slate-800 z-10 flex flex-col items-center" style="left: ${q3Pos}%"><div class="h-4 w-px bg-slate-800"></div><span class="text-[10px] font-bold text-slate-700 mt-1 bg-white px-1 border rounded">Q3</span></div>`;

                const progressHtml = `
                    <div class="w-full relative mt-1 mb-4">
                        <div class="flex justify-between text-xs text-slate-500 mb-1">
                            <span>0%</span>
                            <span class="font-bold text-slate-800">${pct.toFixed(2)}%</span>
                        </div>
                        <div class="h-4 bg-slate-200 rounded-full relative overflow-hidden border border-slate-300">
                            <div class="h-full ${barColor} bar-chart-col" style="width: 0%" data-h="${Math.min(pct, 100)}"></div>
                        </div>
                        ${markersHtml}
                    </div>
                `;

                tbody.innerHTML += `
                    <tr class="border-b border-slate-200 hover:bg-slate-100 transition-colors">
                        <td class="px-6 py-4 font-medium text-slate-800"><div class="leading-relaxed">${act.name}</div></td>
                        <td class="px-4 py-4 text-center text-slate-600 font-medium">${act.unit}</td>
                        <td class="px-4 py-4 text-right font-bold text-slate-700">${formatNum(act.target)}</td>
                        <td class="px-4 py-4 text-right font-bold text-blue-700">${formatNum(act.actual)}</td>
                        <td class="px-6 py-4 pb-8">${progressHtml}</td>
                        <td class="px-6 py-4 text-center">
                            <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold border ${getStatusStyles(act.status)}">${act.status}</span>
                        </td>
                    </tr>
                `;
            });

            setTimeout(() => {
                document.querySelectorAll('#table-body .bar-chart-col').forEach(bar => {
                    bar.style.width = bar.getAttribute('data-h') + '%';
                });
            }, 100);
            
        });
    </script>
</body>
</html>